innerText='الموديل لم يحمل بعد'; return; }
      let changed=false;
      avatar.traverse(o=>{
        if(o.isMesh && /shirt|top|dress|clothes|jacket|coat|body/i.test(o.name)){
          if(o.material && o.material.color){ o.material.color.set(Math.random()*0xffffff); changed=true; }
        }
      });
      status.innerText = changed ? 'تغيير لون اللبس' : 'لم أجد أجزاء قابلة للتغيير';
    });

    document.getElementById('resetCam').addEventListener('click', ()=>{ camera.position.set(0,1.6,2.8); controls.target.set(0,1.4,0); controls.update(); status.innerText='كاميرا أُعيدت'; });

    // ===== استجابة تغيير حجم الشاشة =====
    window.addEventListener('resize', ()=>{ camera.aspect = innerWidth/innerHeight; camera.updateProjectionMatrix(); renderer.setSize(innerWidth, innerHeight); updateMouthOverlay(); });

    // رسالة ترحيب
    window.addEventListener('load', ()=>{ setTimeout(()=>{ overlay.innerText = 'هاي! أنا كيرا — اسألي وانا أرد عليك :)'; simulateSpeak('هاي! أنا كيرا — اسألي وانا أرد عليك'); }, 900); });

    // ===== ملاحظات أمنية للمطور =====
    // - عند دمج LLM حقيقي: ضع باكند يطبّق فلتر للمواضيع الحساسة (طبية/قانونية/عنف/إيذاء).
    // - لا ترسل بيانات حساسة لموديلات بدون موافقة المستخدم.
    // - لو ستخدم TTS خارجي احتفظ بالمفاتيح في backend وليس في الواجهة الأمامية.
  </script>
</body>
</html>
